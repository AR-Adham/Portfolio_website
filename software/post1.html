<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fox and Cayote enclosure simulation - My Portfolio</title>
  <link rel="stylesheet" href="../style.css"/>
  <style>
    /* === PDF slideshow styles === */
    .pdfshow {
      --h: 560px;
      --btn-size: 42px;
      position: relative;
      max-width: 960px;
      margin: 1.5rem auto;
      border-radius: 16px;
      overflow: hidden;
      background: #000;
      box-shadow: 0 8px 24px rgba(0,0,0,.12);
    }
    .pdfstage { display: grid; place-items: center; height: var(--h); background: #000; }
    #pdfCanvas { width: 100%; height: 100%; object-fit: contain; background: #000; }

    .nav-btn {
      position: absolute; top: 50%; transform: translateY(-50%);
      width: var(--btn-size); height: var(--btn-size);
      border-radius: 999px; border: none; cursor: pointer;
      background: rgba(255,255,255,.85);
      display: grid; place-items: center;
      transition: background .2s ease, transform .2s ease;
    }
    .nav-btn:hover { background: #fff; transform: translateY(-50%) scale(1.06); }
    .prev { left: .5rem; }
    .next { right: .5rem; }
    .nav-btn svg { width: 22px; height: 22px; }

    .controls {
      position: absolute; left: 50%; transform: translateX(-50%);
      bottom: .5rem; display: flex; gap: .5rem; align-items: center;
      background: rgba(0,0,0,.35); border-radius: 999px; padding: .35rem .6rem;
      color: #fff; font: 500 14px/1 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    }
    .controls button {
      border: none; border-radius: 999px; padding: .35rem .6rem; cursor: pointer;
      background: rgba(255,255,255,.9);
    }
    .page-indicator { padding: .2rem .5rem; background: rgba(0,0,0,.45); border-radius: 999px; }
    .download { max-width: 960px; margin: 1.25rem auto; }
    .download a { font-weight: 600; text-decoration: none; }
    @media (max-width: 700px) {
      .pdfshow { --h: 420px; }
      .nav-btn { display: none; }
    }

    /* video section */
    .video-demo {
      max-width: 960px;
      margin: 1.5rem auto;
      text-align: center;
    }
    .video-demo video {
      width: 100%;
      border-radius: 12px;
      box-shadow: 0 6px 18px rgba(0,0,0,.18);
    }
    .video-demo p {
      margin-top: .6rem;
      font: 500 14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      color: #444;
    }

    .error-banner{
      position:absolute; inset:auto 0 0 0; background:#b00020; color:#fff;
      padding:.6rem .9rem; font: 500 14px/1.3 system-ui; text-align:center;
    }
  </style>
</head>
<body>
  <header>
    <nav class="container nav-bar">
      <div class="nav-left breadcrumb"><a href="../index.html">Adhams Portfolio</a>/<a href="../software.html">software</a>/Fox and Cayote enclosure simulation<span class="cursor"></span></div>
      <ul class="nav-links">
        <li><a href="../index.html">Home</a></li>
        <li><a href="../software.html">Software</a></li>
        <li><a href="../mechanical.html">Mechanical</a></li>
        <li><a href="../index.html#about">About</a></li>
        <li><a href="../index.html#contact">Contact</a></li>
      </ul>
    </nav>
  </header>

  <main class="container projects">
    <article class="post-article">
      <div class="post-image"><img src="../apsc103group.jpg" alt="Post Image"/></div>
      <h1>Fox and Cayote enclosure simulation</h1>
      <p>Me and my APSC 103 group, developed an agent-based simulation to model the interactions of foxes and coyotes within wildlife enclosures, 
        using Python, NumPy, and Pygame. The back-end was designed to capture animal movement, behavior, and population dynamics, 
        while the front-end included interactive sliders, buttons, and progress bars for user-controlled parameters. 
        The simulation was applied to the Sandy Pines Wildlife Centre, where it supported analysis of trap placement and enclosure mapping strategies. 
        This project enhanced my skills in object-oriented programming, data structures, and user interface design, 
        while demonstrating how computational modeling can contribute to ecological management and informed decision-making.</p>
      
      <!-- Video demo -->
      <section class="video-demo">
        <video controls poster="../apsc103group.jpg">
          <source src="../apsc103demo.mp4" type="video/mp4">
          Your browser does not support the video tag.
        </video>
        <p>Demonstration of the APSC 103 fox & coyote simulation in action.</p>
      </section>

      <p>My main role on the project was developing the brain of the Cannids, aswell as developing the architechture in which the simulation ran. 
        TMy primary responsibility on the project was developing both the decision-making “brain” of the canids and the underlying simulation architecture.
        The brain functioned as an engine that determined each animal’s next action based on the time elapsed since its last activity. 
        The probability weights guiding these decisions were informed by academic research on fox and coyote behavior. 
        To support this, I designed the simulation architecture using a 3D array structure, 
        where each layer tracked specific information such as animal locations, terrain types, family groups, and food sources, 
        enabling complex and realistic interactions within the virtual environment.
      </p>

      <!-- PDF Auto-Slideshow -->
      <section class="pdfshow" id="pdfShow"
               data-src="../APSC103.pdf"
               data-interval="3500"
               data-loop="true"
               data-autoplay="true">
        <div class="pdfstage">
          <canvas id="pdfCanvas" aria-label="Slide canvas"></canvas>
        </div>

        <!-- Navigation -->
        <button class="nav-btn prev" aria-label="Previous slide">
          <svg viewBox="0 0 24 24" fill="none"><path d="M15 6l-6 6 6 6" stroke="#111" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
        <button class="nav-btn next" aria-label="Next slide">
          <svg viewBox="0 0 24 24" fill="none"><path d="M9 6l6 6-6 6" stroke="#111" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>

        <!-- Controls -->
        <div class="controls" role="toolbar" aria-label="PDF controls">
          <button id="togglePlay" aria-pressed="true">⏸ Pause</button>
          <span class="page-indicator"><span id="pageNum">1</span> / <span id="pageCount">—</span></span>
        </div>
      </section>

    </article>
  </main>

  <footer>
    <div class="container"><p>&copy; 2025 Adham Abdelrahim.</p></div>
  </footer>

  <script src="../script.js"></script>

  <!-- === PDF.js v3 (stable classic worker) === -->
  <script src="https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc =
      "https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js";

    (function(){
      const root = document.getElementById('pdfShow');
      const pdfUrl = root.getAttribute('data-src');
      const autoplayDefault = root.getAttribute('data-autoplay') === 'true';
      const loop = root.getAttribute('data-loop') === 'true';
      const intervalMs = parseInt(root.getAttribute('data-interval') || '4000', 10);

      const canvas = document.getElementById('pdfCanvas');
      const ctx = canvas.getContext('2d');
      const btnPrev = root.querySelector('.prev');
      const btnNext = root.querySelector('.next');
      const btnToggle = document.getElementById('togglePlay');
      const pageNumEl = document.getElementById('pageNum');
      const pageCountEl = document.getElementById('pageCount');

      let pdfDoc = null, pageNum = 1, rendering = false, pending = null;
      let autoplay = autoplayDefault, timer = null;

      function fitViewport(page){
        const container = root.querySelector('.pdfstage');
        const W = container.clientWidth, H = container.clientHeight;
        const vp1 = page.getViewport({ scale: 1 });
        const scale = Math.min(W / vp1.width, H / vp1.height);
        return page.getViewport({ scale });
      }

      function render(num){
        rendering = true;
        pdfDoc.getPage(num).then(page => {
          const vp = fitViewport(page);
          canvas.width = Math.floor(vp.width);
          canvas.height = Math.floor(vp.height);
          page.render({ canvasContext: ctx, viewport: vp }).promise.then(() => {
            rendering = false;
            pageNumEl.textContent = pageNum;
            if (pending !== null){ const n = pending; pending = null; render(n); }
          });
        }).catch(err=>console.error(err));
      }
      function queue(num){ rendering ? pending = num : render(num); }

      function next(pause=true){
        if (pageNum >= pdfDoc.numPages) pageNum = loop ? 1 : pdfDoc.numPages;
        else pageNum++;
        queue(pageNum); if(pause) restart();
      }
      function prev(pause=true){
        if (pageNum <= 1) pageNum = loop ? pdfDoc.numPages : 1;
        else pageNum--;
        queue(pageNum); if(pause) restart();
      }

      function start(){ if(!autoplay) return; stop(); timer=setInterval(()=>next(false), intervalMs); btnToggle.textContent='⏸ Pause'; }
      function stop(){ if(timer){ clearInterval(timer); timer=null; } btnToggle.textContent='▶️ Play'; }
      function restart(){ stop(); start(); }

      btnNext.addEventListener('click', ()=>next(true));
      btnPrev.addEventListener('click', ()=>prev(true));
      btnToggle.addEventListener('click', ()=>{ autoplay=!autoplay; autoplay?start():stop(); });

      root.tabIndex = 0;
      root.addEventListener('keydown', e=>{
        if(e.key==='ArrowRight') next(true);
        if(e.key==='ArrowLeft') prev(true);
        if(e.key===' '){ e.preventDefault(); btnToggle.click(); }
      });

      root.addEventListener('mouseenter', stop);
      root.addEventListener('mouseleave', start);

      pdfjsLib.getDocument(pdfUrl).promise.then(pdf=>{
        pdfDoc=pdf;
        pageCountEl.textContent=pdfDoc.numPages;
        render(pageNum);
        start();
        window.addEventListener('resize', ()=>queue(pageNum));
      }).catch(err=>{
        console.error("PDF load error:",err);
        const iframe=document.createElement('iframe');
        iframe.src=pdfUrl; iframe.width="100%"; iframe.height="560"; iframe.style.border="none";
        root.innerHTML=""; root.appendChild(iframe);
      });
    })();
  </script>
</body>
</html>
